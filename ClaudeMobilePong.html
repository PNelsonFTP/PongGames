<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Claude Mobile Pong</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: #006400;
        touch-action: none;
    }
    #gameCanvas {
        display: block;
        background: #006400;
    }
    #score {
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        color: #fff;
        font-family: sans-serif;
        font-size: 24px;
        user-select: none;
    }
    #title {
        position: absolute;
        top: 10px;
        left: 10px;
        color: #fff;
        font-family: sans-serif;
        font-size: 24px;
        user-select: none;
    }
    #addBall {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 18px;
        padding: 10px 20px;
        touch-action: auto;
    }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="title">PacoPong</div>
<div id="score">0 : 0</div>
<button id="addBall">Add Ball</button>
<script>
let canvas = document.getElementById('gameCanvas');
let ctx = canvas.getContext('2d');
let scoreElem = document.getElementById('score');

let width, height, paddleWidth, paddleHeight;
let paddle1, paddle2, balls;
let score1 = 0, score2 = 0;

function createBall() {
    return {
        x: width / 2,
        y: height / 2,
        vx: width * 0.003 * (Math.random() > 0.5 ? 1 : -1),
        vy: height * 0.003 * (Math.random() * 2 - 1),
        r: width * 0.015
    };
}

function resize() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;

    paddleWidth = Math.max(10, width * 0.02);
    paddleHeight = height * 0.2;
    paddle1 = { x: 10, y: (height - paddleHeight) / 2 };
    paddle2 = { x: width - paddleWidth - 10, y: (height - paddleHeight) / 2 };
    balls = [createBall()];
}
window.addEventListener('resize', resize);
window.addEventListener('orientationchange', resize);
resize();

function resetBall(b) {
    b.x = width / 2;
    b.y = height / 2;
    b.vx = width * 0.003 * (Math.random() > 0.5 ? 1 : -1);
    b.vy = height * 0.003 * (Math.random() * 2 - 1);
}

function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
}

function handleTouch(evt) {
    evt.preventDefault();
    for (let t of evt.touches) {
        if (t.clientX < width / 2) {
            paddle1.y = clamp(t.clientY - paddleHeight / 2, 0, height - paddleHeight);
        } else {
            paddle2.y = clamp(t.clientY - paddleHeight / 2, 0, height - paddleHeight);
        }
    }
}
canvas.addEventListener('touchstart', handleTouch);
canvas.addEventListener('touchmove', handleTouch);

function addBall() {
    balls.push(createBall());
}
document.getElementById('addBall').addEventListener('click', addBall);

function update() {
    for (let b of balls) {
        b.x += b.vx;
        b.y += b.vy;

        if (b.y - b.r < 0 || b.y + b.r > height) {
            b.vy *= -1;
        }

        if (b.x - b.r < paddle1.x + paddleWidth && b.y > paddle1.y && b.y < paddle1.y + paddleHeight) {
            b.vx = Math.abs(b.vx);
        }
        if (b.x + b.r > paddle2.x && b.y > paddle2.y && b.y < paddle2.y + paddleHeight) {
            b.vx = -Math.abs(b.vx);
        }

        if (b.x < 0) {
            score2++;
            scoreElem.textContent = `${score1} : ${score2}`;
            resetBall(b);
        }
        if (b.x > width) {
            score1++;
            scoreElem.textContent = `${score1} : ${score2}`;
            resetBall(b);
        }
    }
}

function draw() {
    ctx.clearRect(0, 0, width, height);

    ctx.strokeStyle = '#555';
    ctx.setLineDash([5, 15]);
    ctx.beginPath();
    ctx.moveTo(width / 2, 0);
    ctx.lineTo(width / 2, height);
    ctx.stroke();
    ctx.setLineDash([]);

    ctx.fillStyle = '#fff';
    ctx.fillRect(paddle1.x, paddle1.y, paddleWidth, paddleHeight);
    ctx.fillRect(paddle2.x, paddle2.y, paddleWidth, paddleHeight);

    ctx.beginPath();
    for (let b of balls) {
        ctx.moveTo(b.x + b.r, b.y);
        ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
    }
    ctx.fill();
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
